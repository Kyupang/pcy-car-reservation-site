<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Car Reservation</title>
  <link rel="stylesheet" href="../styles.css">
  <title>Calendar Page</title>
  <!-- FullCalendar CSS -->
  <link href="https://cdn.jsdelivr.net/npm/fullcalendar@5.10.1/main.min.css" rel="stylesheet"/>
  <style>
        /* FullCalendar에서 예약 불가능한 날짜 스타일링 */
        .fc-event-reserved {
            background-color: red;
            border-color: red;
        }

    </style>
</head>
<body>
<header>
  <div class="logo">
    <a href="/"><img src="../home-icon.png" alt="Home Icon"></a>
  </div>
  <nav>
    <ul>
      <li><a href="/reservation/calendar">캘린더</a></li>
      <li><a href="/post/carImagePostList">촬영 게시판</a></li>
      <li><a href="/post/wishPostList">건의 게시판</a></li>
      <li><a href="/reservation/textList">예약 목록</a></li>
      <li><a href="/managerLogin">관리자 페이지</a></li>
    </ul>
  </nav>
  <div class="profile">
    <!--        <a href="#"><img src="profile-icon.png" alt="Profile Icon"></a>-->
  </div>
</header>
<h1>예약 확인 캘린더</h1>
<div id="calendar"></div> <!-- FullCalendar를 표시할 DIV -->

<!-- FullCalendar JS -->
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.10.1/main.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    var calendarEl = document.getElementById('calendar');

    var calendar = new FullCalendar.Calendar(calendarEl, {
        initialView: 'dayGridMonth',
        events: `/reservation/getReservationList`,
        eventContent: function(arg) {
            var startTime = formatTime(arg.event.start);
            var endTime = arg.event.end ? formatTime(arg.event.end) : 'N/A';
            var carName = arg.event.extendedProps.carName; // 차량 이름 가져오기

            return {
                html: `
                    <div>
                        <strong>${carName}</strong><br>
                        <strong>Start:</strong> ${startTime}<br>
                        <strong>End:</strong> ${endTime}
                    </div>
                `
            };
        },
        eventClassNames: function(event) {
            return event.reserved ? 'fc-event-reserved' : '';
        }
    });
    calendar.render();
});

// 시간을 AM/PM 형식으로 변환하는 함수
function formatTime(date) {
    var hours = date.getHours();
    var minutes = date.getMinutes();
    var ampm = hours >= 12 ? 'PM' : 'AM';
    hours = hours % 12;
    hours = hours ? hours : 12; // 0 시는 12로 변환
    minutes = minutes < 10 ? '0' + minutes : minutes;
    return hours + ':' + minutes + ' ' + ampm;
}
</script>
</body>
</html>
